function getFooter(){var n=unescape($("#hid_kLogin_footerUrl").val()),t=$("#footerBox");t.length==1&&$.trim(n)!=""&&$.getJSON(n,function(n){t.html(unescape(n.html))})}function modifyEcpHeader(n){$("#Ecp_header_Help").before("<a  class='ecp_tn-tab' href='http://kns.cnki.net/kns/subPage/map.aspx'><i>网站地图<\/i><\/a>");$("#Ecp_header_ChargeCenter").before(mycnkihtml());n&&$(".ecp_top-nav").append(logohtml())}function mycnkihtml(){var t="",n;return GetCookies("LID")&&(t="uid="+GetCookies("LID")),n="<span class='mycnki topItem' id='spanmycnki'>",n+="<a id='link_mycnki' href='javascript:void(0);' onclick='setmycnkiclass()'>我的记录<i class='ecp_tn-arrow'><\/i><\/a>",n+="<div id='pop_mycnki' class='topItemPop mycnkipop' style='display:none;'>",n+="<a class='close' href='javascript:void(0)' onclick='$(this).parent().hide()'>x<\/a>",n+="<div class='klogin_fr'>",n+="<ul class='mlist'>",n+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+t+"' target='_blank'>进入 <b>我的记录<\/b> &gt;&gt;<\/a><\/li>",n+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+t+"&amp;turnId=keyWord' target='_parent'>我的检索词<\/a><\/li>",n+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+t+"&amp;turnId=recArticle' target='_parent'>我的推荐<\/a><\/li>",n+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+t+"&amp;turnId=downLoad' target='_parent'>我的下载<\/a><\/li>",n+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+t+"&amp;turnId=view' target='_parent'>我的浏览<\/a><\/li>",n+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+t+"&amp;turnId=read' target='_parent'>我的阅读<\/a><\/li>",n+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+t+"&amp;turnId=share' target='_parent'>我的分享<\/a><\/li>",n+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+t+"&amp;turnId=export' target='_parent'>我的导出<\/a><\/li>",n+="<li><a href='http://kns.cnki.net/KMycnki/Mycnki/index?"+t+"&amp;turnId=analysis' target='_parent'>我的分析<\/a><\/li>",n+=" <li><a href='http://kns.cnki.net/knsdelivery/mycnki.aspx?"+t+"' target='_parent'>我的关注<\/a><\/li>",n+="<\/ul><\/div>",n+="<div class='klogin_fl'>",n+="<ul class='mlist'>",n+="<li class='prompt'><span>您好，登录可以查看更多信息<\/span><\/li>",n+"<\/ul><\/div><\/div><\/span>"}function logohtml(){var n="<div class='Logo'>";return n+="<a href='http://www.cnki.net'>",n+="<img src='http://kns.cnki.net/kns/images/gb/logo.gif' alt='中国知网'>",n+="<img class='logohome' src='http://kns.cnki.net/kns/images/gb/home.gif'>",n+"<\/a><\/div>"}function setmycnkiclass(){$("#spanmycnki").toggleClass("topItemCur");$("#pop_mycnki").toggle()}function LoginSucess(n){$.post(APPPATH+"/login/LoginIn",{uid:n.Uid},function(){})}function Ecp_LogoutOptr(){var n=APPPATH+"/login/LoginOut";$.post(n,null,function(){location.reload()})}function GetCookies(n){var t="[;]*[s]*"+n+"=([^;]*)",i=new RegExp(t);return i.test(document.cookie)?RegExp.$1:""}function GetCurUID(){var n=GetCookies("LID");return n||(n=$("#hid_uid").val()),n}function DownLoadReportIMG(n){var t=$(n).parent().siblings("img").attr("src"),i,r;($(n).hasClass("table")&&(t=$(n).attr("data-tablename")),t!=undefined&&t!="")&&(i=/=(.*[jpg jpeg bmp png xlsx])&/.exec(t),i)&&(r=i[1],downByForm(t))}function downByForm(n){var t=document.createElement("form");t.id="tempForm";t.action=n.indexOf("http:")>-1?n:APPPATH+"/"+n;t.target="_blank";t.method="post";document.body.appendChild(t);t.submit();document.body.removeChild(t)}function fake_click(n){var t;document.createEventObject?(t=document.createEventObject(),n.fireEvent(t)):(t=document.createEvent("MouseEvents"),t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.stopPropagation(),n.dispatchEvent(t))}function export_raw(n,t){var i=document.createElement("a");i.target="_blank";i.href=t;i.download=n;fake_click(i)}function DownLoadReportExcel(n){var i=$(n).parent().find("table"),r=i.prop("outerHTML"),u=$(n).parent().find(".img_tit").html(),t=$(n).parent().find("form");$(t).find("input:eq(0)").val(r);$(t).find("input:eq(1)").val(u);$(t).submit()}function navA(){this.navList=$(".sidenav-list");this.leftH=this.navList.outerHeight();this.aTop=0;this.scrollFun()}function searchCRFD(n){$("#GLSearch").css("display","none");var t=GLS.Text;t&&$(n).attr("href","http://gongjushu.cnki.net/refbook/BasicSearch.aspx?kw="+encodeURIComponent(t))}var dbname,common,GLS;$.fn.extend({mousewheel:function(n){function u(i){var u=0,r=0,i=i||window.event;+'\v1'?(i.stopPropagation(),i.preventDefault()):(i.cancelBubble=!0,i.returnValue=!1);i.wheelDelta?r=i.wheelDelta:i.deltaY?r=i.deltaY*-1:i.wheelDeltaY?r=i.wheelDeltaY:console.log("get delta,have somethings wrong...");r==0?console.log("get delta,have somethings wrong..."):u=r>0?1:-1;typeof n=="function"?n($(t),u):""}var r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],t,i;if(this.length!=0)if(t=this[0],t.addEventListener)for(i=r.length;i;)t.addEventListener(r[--i],u,!1);else t.onmousewheel=u}});document.onkeydown=function(n){n=n?n:window.event;n.ctrlKey&&n.keyCode==67&&(n.preventDefault?n.preventDefault():n.returnValue=!1)},function(n){var t=function(){},i;t.load=function(){getFooter();i()};i=function(){function f(n,t){n.parent().width()==0?(n.parent().animate({width:t},"fast"),n.parent().parent().animate({width:t},"fast")):(n.parent().animate({width:"0"},"fast"),n.parent().parent().animate({width:"0"},"fast"));n.toggleClass("off");n.parent().toggleClass("off")}var u,t,i;n(".guide p").click(function(){var t=n(".guide p").index(n(this));n(".guide p").eq(t).siblings("div").slideToggle();n(".guide p").eq(t).parent().toggleClass("selected")});u=n(".sidebar-a").outerWidth();n(".sidebar-a").find(".arrow").click(function(){f(n(this),u)});n(".guide").each(function(){n(this).find("ul").length==0&&n(this).addClass("noico")});var e=10,o=10,r=[];n("a.sup").mouseenter(function(t){var i,u;(t.stopPropagation(),n(this).attr("data-title")!=undefined&&n(this).attr("data-title")!="")&&(i="tooltip"+n(this).text().replace(/\[|\]|,/g,""),n("#"+i).length==0&&(u="<div class='tooltip' id="+i+">"+n(this).attr("data-title")+"<\/div>",n("body").append(u),r.push(i)),n("#"+i).css({top:t.pageY+o+"px",left:t.pageX+e+"px"}).show(),n("#"+i).mouseleave(function(){n("#"+i).remove()}))});n(document).on("click",function(){for(var t in r)n("#"+r[t]).remove()});t="";i={};n("citation").each(function(){var f,r,u;n(this).children("link").each(function(){if(n(this).attr("href").length>0){fn=n(this).attr("href");var i=fn.split("/");i&&(fn=i[i.length-1]);t+=fn.indexOf(".")>-1?fn.substring(0,fn.indexOf("."))+",":fn+",";r=/.(\w+)$/.exec(fn)[1].toLowerCase()}});i[n(this).attr("id")]=fn.indexOf(".")>-1?fn.substring(0,fn.indexOf(".")):fn;f="Detail/Redirect?dbcode=cjfd&filename="+fn+"&type="+r;u="<span id="+n(this).attr("id")+' class="func-group anchor-tag">';u+='<a class="filename" target="_blank" href="'+f+'"><em>'+n(this).text()+"<\/em><\/a>";u+="<\/span>";n(this).html(u);n("<li id=zq"+n(this).attr("id")+"><a href="+f+' target="_blank"><em>'+n(this).text()+'<\/em><i class="icon icon-'+r+'"><\/i><\/a><\/li>').appendTo(n(".zqscroller ul"));r=="mp4"?n("#audioinfo p").appendTo(".zqscroller ul"):n("#pdfinfo p").appendTo(".zqscroller ul")});t&&(t=t.substr(0,t.length-1),n.get(APPPATH+"/Detail/ZQTitle?filename="+t,function(t){n(".zqscroller li").each(function(){var u=n(this).attr("id").substr(2),r=n(this);n.each(t,function(f){if(t[f].FileName==i[u])return n(r).find("em").text(t[f].Title),n(r).find("a").attr("title",t[f].Title),!1})})}))};window.KXR.Detail=t}(jQuery);$(function(){function n(n,i){var r=new Image;r.onload=function(){r.height>t&&$(i).css("height",r.height*.215)};r.src=this.src}window.KXR.Detail.load();var t=48;$(".content p img[type='image']").each(n);$(".content p img[type='formula']").each(n);$(".content").find(".area_img>img").each(function(n,t){var i=new Image;i.onload=function(){$(t).css("width",i.width*.3)};i.src=this.src});$(".area_img a").click(function(){DownLoadReportIMG($(this))})}),function(){function i(n,t){this.el=n;this.opts=$.extend({Container:".content",anchorTag:".anchor-tag"},t);this.footerH=$(".footer").length>0?$(".footer").outerHeight():0;this.minTop=$(".header").outerHeight(!0)}function u(){this.content=$(".content");this.sideb=$(".sidebar-b");this.numBtn=this.content.find(".sup");this.funcBtn=this.content.find(".filename");this.referbox=this.sideb.find(".refer");this.closeBtn=this.sideb.find(".close");this.sidebW=this.sideb.outerWidth();this.offBtn=this.sideb.find(".arrow");this.title=this.sideb.find(".tit");this.referList=this.sideb.find(".refer-list");this.scrollRight=new i(this.referbox,{anchorTag:""});this.subbox=this.sideb.find(".subbox");this.sideScroller=this.sideb.find(".side-scroller");this.defaultTop=this.sideScroller.position().top;this.p=this.content.find(".data p,.p1,citation");this.zqbox=this.sideb.find(".zqscroller");this.zqboxli=this.zqbox.find("li")}var n=0,r,f;i.prototype={init:function(){var n=this;n.bindscroll();n.anchorClick()},clearEvent:function(){var n=this;n.el.find("a").unbind()},bindscroll:function(){var t=this;$(window).on("load scroll",function(){var u=$(document).height(),f=$(t.opts.Container).outerHeight(),i=Math.max(document.body.scrollTop,document.documentElement.scrollTop),r;(maxTop=u-t.footerH-t.el.height(),i>t.minTop&&i<maxTop&&t.el.css({position:"fixed",top:0,"margin-top":""}),i>=maxTop?t.el.css({position:"","margin-top":f-t.el.height()+"px"}):i<=t.minTop&&t.el.css({position:"","margin-top":""}),n!=1)&&(r=[],$(t.opts.anchorTag)!=undefined&&$(t.opts.anchorTag)!=""&&$(t.opts.anchorTag).length>0&&($(t.opts.anchorTag).each(function(){minH=i;maxH=minH+$(window).height();var n=$(this).attr("id");if(minH<=$(this).offset().top&&maxH>=$(this).offset().top)return n!=""&&r.push(n),!1}),r.length==1&&t.goalScroll("#"+r[0])))})},anchorClick:function(){var t=this;t.el.find("a").click(function(i){(t.el.hasClass("sidenav")&&i.preventDefault(),i.stopPropagation(),_id=$(this).attr("href"),_id!=undefined&&_id!="#"&&_id.indexOf("#",0)!=-1&&_id!="javascript:void(0)")&&(t.goalScroll(_id),t.el.hasClass("sidenav")&&(n=1),$("body,html").animate({scrollTop:$(_id).offset().top},200,"swing",function(){t.el.hasClass("sidenav")&&setTimeout(function(){n=0},100)}))})},goalScroll:function(n){var t=this;n!=""&&n.indexOf("#",0)!=-1&&(t.el.find("a").removeClass("cur"),t.el.find("a[href='"+n+"']").addClass("cur"))}};r=new i($(".sidenav"),{anchorTag:".anchor-tag"});r.init();u.prototype={init:function(){var n=this;n.initSubBoxH();n.scrollRight.init();n.OnOff();n.bindCloseBtn();n.bindReferBtn();n.bindFuncBtn();n.scrollFunc();n.bindNavClick();n.bindPOver();$(window).on("scroll resize",function(){n.initSubBoxH();n.referbox.css("position")=="fixed"&&($(window).width()<1200?n.referbox.css("right",$(window).width()-1200+$(window).scrollLeft()+"px"):n.referbox.css("right",0));n.referbox.width(n.referbox.parent().width()-2)})},initSubBoxH:function(){var n=this;subboxH=$(window).height();n.subbox.height(subboxH)},clearScrollTop:function(){var n=this;n.sideScroller.css({top:"","margin-top":0})},OnOff:function(){var n=this;n.offBtn.on("click",function(){n.myAnimate2($(this),n.sidebW)})},myAnimate2:function(n,t,i){i=i==undefined?!0:i;n.parent().parent().width()==0?(n.siblings().slideDown(10,function(){n.parent().animate({width:t},"fast");n.parent().parent().animate({width:t-2},"fast")}),n.removeClass("off")):i&&(n.parent().animate({width:"0"},"fast"),n.parent().parent().animate({width:"0"},"fast",function(){n.siblings().slideUp()}),n.addClass("off"))},bindCloseBtn:function(){var n=this;n.closeBtn.click(function(){n.clearScrollTop();n.zqbox.hide();n.title.html("参考文献");n.referbox.removeClass("showrefer onlyshowzq");n.referbox.find("li").removeClass("cur");n.referbox.find(".side-scroller").find(".img-list").length>0&&n.referbox.find(".side-scroller").find(".img-list").remove();n.scrollRight.init()})},getRefIndex:function(n){var t,u,f,e,r,i;if(u=n.substring(1,n.length-1),i={p1:[],p2:[]},u.indexOf(",")>0)for(t=u.split(","),r=0;r<t.length;r++)/[^\d+]/.test(t[r])?t[r].indexOf("-")>0&&(r2=t[r].split("-"),f=parseInt(r2[0]),e=parseInt(r2[1]),i.p2.push(f),i.p2.push(e)):i.p1.push(t[r]);else u.indexOf("-")>0?(t=u.split("-"),f=parseInt(t[0]),e=parseInt(t[1]),i.p2.push(f),i.p2.push(e)):i.p2.push(u);return i},getRefId:function(n,t){for(var o=this,r=o.getRefIndex(n),s=0,i=0,u,f,e,i=0;i<r.p1.length;i++)s=r.p1[i],u=r.p1[0],o.referbox.find("li").eq(s-1).addClass(t);if(r.p2.length>0)for(f=r.p2[0],e=r.p2[1],e==undefined&&(e=f),u=f<u||u==undefined?f:u,i=f;i<=e;i++)o.referbox.find("li").eq(i-1).addClass(t);return u},bindRefTitle:function(n){function o(n){var t=n.find("a"),i="";return i+="<a href='",i+=t.attr("href")!=undefined&&t.attr("href")!=""?t.attr("href")+"'  target='_blank'>":"javascript:;' class='nohref'>",i+(n.text()+"<\/a>")}for(var s=n.html(),h=this,e="",t=0,r,u=0,f,i=h.getRefIndex(s),t=0;t<i.p1.length;t++)r=i.p1[t],f=$("#a_bibliography").find("p").eq(r-1),e+=o(f);if(i.p2.length>0)for(r=i.p2[0],u=i.p2[1],u==undefined&&(u=r),t=r;t<=u;t++)f=$("#a_bibliography").find("p").eq(t-1),e+=o(f);n.attr("data-title",e);n.attr("href","javascript:void(0);")},bindReferBtn:function(){var n=this;n.numBtn.each(function(){n.bindRefTitle($(this))});n.numBtn.click(function(){n.title.html("参考文献");n.myAnimate2(n.offBtn,n.sidebW,!1);n.referbox.find("li").removeClass("selected");var i=$(this).html(),t=n.getRefId(i,"selected");$("#bibliography_"+t).length>0?n.goToPos($(this),$("#bibliography_"+t)):(_objA=n.referbox.find("li:eq("+t+")>a"),n.goToPos($(this),_objA))})},goToPos:function(n,t){if(t){var i=this;minT=i.subbox.height()-i.sideScroller.outerHeight();maxT=i.defaultTop;idPos=t.position().top;calcH=n.offset().top-i.subbox.offset().top;calcH=calcH<maxT?maxT:calcH;goPos=calcH-idPos;i.sideScroller.animate({top:goPos+"px"},200)}},bindPOver:function(){var n=this;n.p.mouseenter(function(t){t.stopPropagation();sup=$(this).find(".sup");zq=$(this).find(".filename");n.referbox.find("li").removeClass("cur selected");sup.length>0?(n.title.html("参考文献"),n.zqboxli.removeClass("cur"),n.referbox.removeClass("onlyshowzq").addClass("showrefer"),sup.each(function(){var t=$(this).html();n.getRefId(t,"cur")}),n.goToPos($(this),n.referbox.find("li.cur").eq(0)),zq.length>0?(n.zqbox.show(),zq.each(function(){n.zqbox.find("#zq"+$(this).parent().attr("id")).addClass("cur")})):zq.length==0&&n.zqbox.hide()):sup.length==0&&zq.length>0?(n.zqbox.show(),n.title.html("增强材料"),n.referbox.removeClass("showrefer").addClass("onlyshowzq"),n.zqboxli.removeClass("cur"),zq.each(function(){thisName=$(this).parents("citation").attr("id");n.zqbox.find("li").each(function(){$(this).attr("id").indexOf(thisName)>-1&&$(this).addClass("cur")})}),n.goToPos($(this),n.referbox.find("li.cur").eq(0))):n.closeBtn.click()})},bindFuncBtn:function(){var n=this;n.funcBtn.click(function(){n.myAnimate2(n.offBtn,n.sidebW,!1);_this=$(this);thisName=$(this).parents("citation").attr("id");n.zqbox.find("li").each(function(){$(this).attr("id").indexOf(thisName)&&(n.goToPos(_this,$(this)),$(this).addClass("selected"))})})},scrollFunc:function(){var n=this;maxMT=0;n.sideScroller.mousewheel(function(i,r){(minMT=n.subbox.height()-i.outerHeight(),minMT>=maxMT)||(t=parseInt(i.css("margin-top"))+20*r,t=t<minMT?minMT:t>maxMT?maxMT:t,console.log(minMT,maxMT),i.css("margin-top",t+"px"))})},bindNavClick:function(){var n=this;$(".sidenav-list").click(function(){n.closeBtn.click()})}};$(".sidebar-b").length>0&&(f=new u,f.init())}();navA.prototype={scrollFun:function(){var n=this;$(".guide").find("a").click(function(){navTop=n.navList.scrollTop();n.aTop=$(this).position().top;n.aTop>0&&n.aTop<100?n.navList.animate({scrollTop:navTop-100},500,"swing"):n.aTop>n.leftH-100&&n.aTop<n.leftH&&n.navList.animate({scrollTop:navTop+100},500,"swing")})}};new navA;dbname="CJFDTOTAL",function(){var n=function(){},t=$("#myexport").val();n.prototype={load:function(){this.sort(".sort","cur");$("#aexport").attr("onclick","window.KXR.DetailHeader.SubTurnExport('"+t+"/kns/ViewPage/viewsave.aspx','"+dbname+"!"+$.getUrlParam("filename")+"')");$("#aguanzhu").attr("onclick","common.AttentionServiceParam('2', '', '"+dbname+"','"+$.getUrlParam("filename")+"', '0');");$("#ashoucang").attr("onclick","common.AddFavTitle('')")},sort:function(n,t){$(n).mouseenter(function(){$selectList=$(this).find("ul");$selectList.show();$selectList.find("a").click(function(){$selectList.siblings().find("span").html($(this).html());$(this).parent().addClass(t).siblings().removeClass(t);$selectList.hide()})}).mouseleave(function(){$selectList.hide()})},SubTurnExport:function(n,t){var i=document.createElement("form"),r;i.method="post";i.setAttribute("target","_blank");i.action=n;r=document.createElement("input");r.setAttribute("name","formfilenames");r.setAttribute("value",t);i.appendChild(r);document.body.appendChild(i);i.submit();document.body.removeChild(i)}};window.KXR.DetailHeader=new n}(),function(){window.KXR.DetailHeader.load()}();common=function(n){var t=n("#myexport").val();return this.RequestJsonObject=function(t,i){function f(n,t,i){var r=navigator.userAgent.indexOf("MSIE")!=-1&&!window.opera;r?t=="load"?(n.onreadystatechange=function(){this.readyState!="loaded"||u||i()},n.onload=function(){i();u=!0}):n.attachEvent("on"+t,function(n){return function(){i.call(n)}}(n)):n.addEventListener(t,i,!1)}function e(n){return document.createElement(n)}var r,u=!1,o;r&&document.body.removeChild(r);r=e("SCRIPT");r.src=t+"&td="+(new Date).getTime();r.charset="utf-8";document.body.appendChild(r);f(r,"load",i);o=n("#myexport").val()},this.Attention=function(){n("#coreContent").css("display")=="none"?(n(".attention div input[type=checkBox]").each(function(){n(this).removeAttr("checked")}),n("#coreContent").css({top:n("#attAuthor").position().top+19}),n("#coreContent").show(),n("#coreContent").unbind("mouseleave").bind("mouseleave",function(){n(".attention div input[type=checkBox]").each(function(){n(this).removeAttr("checked")});n(this).hide()})):n("#coreContent").hide()},this.GetCookie=function(n){var t="[;]*[s]*"+n+"=([^;]*)",i=new RegExp(t);return i.test(document.cookie)?RegExp.$1:""},this.AddFavorite=function(n,t){try{window.external.addFavorite(n,decodeURIComponent(t))}catch(i){try{window.sidebar.addPanel(decodeURIComponent(t),n,"")}catch(i){alert("由于您的浏览器不支持，请使用Ctrl+D进行添加到收藏。")}}},{AttentionServiceParam:function(i,r,u,f,e){t||(t="http://kns.cnki.net");var o=t+"/KnsDelivery/ExtendDB/addattention.ashx?un="+r+"&skey="+GetCookie("cnkiUserKey")+"&type="+i+"&dbName="+u+"&content="+f;e=="1"&&(o=o+"&p=1");try{RequestJsonObject(o,function(){if(typeof result!="undefined"){var t=result.data[0].msg,i=result.data[0].code;e=="1"?i=="2"&&(n("#AttentionYes").show(),n("#AttentionNo").hide(),n("#ahasattention").attr("href",n("#myhasattention").val()),n("#amyattention").attr("href",n("#myhasattention").val())):(n("#popupmsg").html(t+"!"),n("#popupTips").show(),setTimeout(function(){n("#popupTips").fadeOut();n("#popupmsg").html("");n("#AttentionYes").show();n("#AttentionNo").hide()},1e4),n("#ahasattention").attr("href",n("#myhasattention").val()),n("#amyattention").attr("href",n("#myhasattention").val()))}})}catch(s){}n("#coreContent").hide()},AttentionService:function(t){var r=dbname,i=n.getUrlParam("filename");i=encodeURIComponent(i);common.AttentionServiceParam(2,"",r,i,t)},ShareAction:function(i){var r=n.getUrlParam("dbcode"),u=n.getUrlParam("filename"),f=t+"/CRRS/Services/Share.ashx?dbcode="+r+"&dbname="+dbname+"&filename="+u+"&target=kns&type="+i+"&cnkiUserKey="+GetCookie("cnkiUserKey"),e=f;window.open(e,"kcmstarget","width=480,height=430, menubar=no, scrollbars=no,resizable=yes,location=no, status=no")},AddFavTitle:function(n){var t=document.URL;n=n==""?document.title:n;AddFavorite(t,n)}}}(jQuery);common.AttentionService("1"),function(){var n=function(){};n.prototype={renderPage:function(n,t,i,r,u){var e=n.attr("totalcount"),f=10,o;e<10||(f==undefined&&(f=10),o=this,$(n).find(".pages").twbsPagination({startPage:parseInt(1),initiateStartPageClick:!1,visiblePages:u,totalPages:Math.ceil(e/f)<1?1:Math.ceil(e/f),onPageClick:function(u,f){DetailRef.getRefPartialHtml(n,f,t,i,r)}}))},getUrlParam:function(n){var i=new RegExp("(^|&)"+n+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(i);return t!=null?unescape(t[2]):null},getRefHtml:function(n,t,i,r){var u=DetailRef.getUrlParam("dbcode"),o,e,f;if(u=u!=null?u.toUpperCase():"CJFQ",u=="CJFD"&&(u="CJFQ"),o=this,e={0:"Get2CKFile",1:"GetGYFiles",2:"GetYZFiles",3:"Get2YZFiles",4:"GetTBFiles",5:"GetAuthors",6:"GetSimilarFilesDoc",7:"GetKnetFuInfos"},t.html().length<1){if(f=e[i],!f)return;t.html("正在加载...");$.get(APPPATH+"/RefNet/"+f,{dbcode:u,filename:n},function(f){if(t.html(f),i<5){var e=t.find(".refer-box");$.each(e,function(t,f){DetailRef.renderPage($(f),i,u,n,r)})}})}},getRefPartialHtml:function(n,t,i,r,u){var f=n.attr("curdbcode"),e=n.find("ul:eq(0)"),o={0:"Get2CKFilePartial",1:"GetGYFilesPartial",2:"GetYZFilesPartial",3:"Get2YZFilesPartial",4:"GetTBFilesPartial"}[i];$.get(APPPATH+"/RefNet/"+o,{dbcode:r,curdbcode:f,filename:u,page:t},function(n){e.html(n)})}};window.DetailRef=new n}();GLS={};GLS.startObj=null;GLS.isdb=!1;GLS.allow=!0;GLS.Text="";GLS.isallow=function(){GLS.allow?(GLS.allow=!1,alert("搜索已关闭")):(GLS.allow=!0,alert("搜索已打开"))};GLS.dblclick=function(){GLS.isdb=!0};GLS.mousedown=function(n){n=n?n:window.event?window.event:"";n&&(GLS.startObj=n.target?n.target:n.srcElement)};GLS.mouseup=function(n){var t;n=n?n:window.event?window.event:"";n&&(t=n.target?n.target:n.srcElement);t.tagName!="A"&&t.tagName!="INPUT"&&t==GLS.startObj&&!GLS.isdb&&GLS.allow&&GLS.showBtnsDiv(n);GLS.isdb=!1};GLS.showBtnsDiv=function(n){var r,t,i,o;n=n?n:window.event?window.event:"";var u=$("#GLSearch"),f=88,e=this.GetSelectionText();e.toString().length>1?(self.innerWidth?r=self.innerWidth:document.documentElement&&document.documentElement.clientWidth?r=document.documentElement.clientWidth:document.body&&(r=document.body.clientWidth),u.css({display:"block",position:"absolute",zindex:"20000"}),$.support.leadingWhitespace?(o=document.documentElement.scrollTop>0?document.documentElement.scrollTop:document.body.scrollTop,i=n.pageX+f-r,rY=n.pageY-o<25?n.pageY+5:n.pageY-25,t=i>0?n.pageX-i:n.pageX+5):(i=n.clientX+f-r,rY=document.documentElement.scrollTop+n.clientY,t=document.documentElement.scrollLeft+n.clientX,rY=n.clientY<25?rY+5:rY-25,t=i>0?t-i:t+5),u.css("top",rY),u.css("left",t),GLS.Text=e):u.css("display","none")};GLS.GetSelectionText=function(){var t,r="",i=100,n;if(window.getSelection?t=window.getSelection():document.selection&&(t=document.selection.createRange()),!!t&&!!t.getRangeAt)try{n=t.getRangeAt(0);n.commonAncestorContainer.nodeName==="P"?r=n.commonAncestorContainer.innerText.length>i?n.commonAncestorContainer.innerText.substring(n.startOffset,n.startOffset+i):n.commonAncestorContainer.innerText.substring(n.startOffset,n.endOffset):n.commonAncestorContainer.nodeName==="#text"&&(r=n.endOffset-n.startOffset>i?n.commonAncestorContainer.data.substring(n.startOffset,n.startOffset+i):n.commonAncestorContainer.data.substring(n.startOffset,n.endOffset))}catch(u){}return r};GLS.copytextToclipboard=function(){var t=document.getElementById("copytext"),n;if(t&&typeof Clipboard=="function"){n=new Clipboard(t,{text:function(){var n=GLS.Text;return n&&n.length>0?n+("[…]\n摘自："+$(".top-title").text().trim()+"\n在中国知网查看："+window.location.href+"\n本作品由中国知网阅读全球范围内电子版制作与发行。 版权所有，侵权必究。"):""}});n.on("success",function(){$("#GLSearch").css("display","none");alert("内容已成功复制到剪切板")});n.on("error",function(){})}};$(document).ready(function(){$(document).bind("contextmenu",function(){return!1});$(document).bind("keydown",function(n){return n=n?n:window.event,n.ctrlKey&&n.keyCode==67?!1:void 0});GLS.copytextToclipboard();$(".content").mousedown(GLS.mousedown).dblclick(GLS.dblclick).mouseup(GLS.mouseup)}),function(n,t,i,r){"use strict";var f=n.fn.twbsPagination,u=function(i,r){var e,u,f;if(this.$element=n(i),this.options=n.extend({},n.fn.twbsPagination.defaults,r),this.options.startPage<1||this.options.startPage>this.options.totalPages)throw new Error("Start page option is incorrect");if(this.options.totalPages=parseInt(this.options.totalPages),isNaN(this.options.totalPages))throw new Error("Total pages option is not correct!");if(this.options.visiblePages=parseInt(this.options.visiblePages),isNaN(this.options.visiblePages))throw new Error("Visible pages option is not correct!");if(this.options.totalPages<this.options.visiblePages&&(this.options.visiblePages=this.options.totalPages),this.options.onPageClick instanceof Function)this.$element.first().on("page",this.options.onPageClick);return this.options.href&&(u=this.options.href.replace(/[-\/\\^$*+?.|[\]]/g,"\\$&"),u=u.replace(this.options.hrefVariable,"(\\d+)"),(e=new RegExp(u,"i").exec(t.location.href))!=null&&(this.options.startPage=parseInt(e[1],10))),f=typeof this.$element.prop=="function"?this.$element.prop("tagName"):this.$element.attr("tagName"),this.$listContainer=f==="UL"?this.$element:n("<ul><\/ul>"),this.$listContainer.addClass(this.options.paginationClass),f!=="UL"&&this.$element.append(this.$listContainer),this.render(this.getPages(this.options.startPage)),this.setupEvents(),this.options.initiateStartPageClick&&this.$element.trigger("page",this.options.startPage),this};u.prototype={constructor:u,destroy:function(){return this.$element.empty(),this.$element.removeData("twbs-pagination"),this.$element.off("page"),this},show:function(n){if(n<1||n>this.options.totalPages)throw new Error("Page is incorrect.");return this.render(this.getPages(n)),this.setupEvents(),this.$element.trigger("page",n),this},buildListItems:function(n){var t=[],r,i,u;for(this.options.first&&t.push(this.buildItem("first",1)),this.options.prev&&(r=n.currentPage>1?n.currentPage-1:this.options.loop?this.options.totalPages:1,t.push(this.buildItem("prev",r))),i=0;i<n.numeric.length;i++)t.push(this.buildItem("page",n.numeric[i]));return this.options.next&&(u=n.currentPage<this.options.totalPages?n.currentPage+1:this.options.loop?1:this.options.totalPages,t.push(this.buildItem("next",u))),this.options.last&&t.push(this.buildItem("last",this.options.totalPages)),t},buildItem:function(t,i){var r=n("<li><\/li>"),f=n("<a><\/a>"),u=null;switch(t){case"page":u=i;r.addClass(this.options.pageClass);break;case"first":u=this.options.first;r.addClass(this.options.firstClass);break;case"prev":u=this.options.prev;r.addClass(this.options.prevClass);break;case"next":u=this.options.next;r.addClass(this.options.nextClass);break;case"last":u=this.options.last;r.addClass(this.options.lastClass)}return r.data("page",i),r.data("page-type",t),r.append(f.attr("href",this.makeHref(i)).html(u)),r},getPages:function(n){var u=[],f=Math.floor(this.options.visiblePages/2),t=n-f+1-this.options.visiblePages%2,i=n+f,r;for(t<=0&&(t=1,i=this.options.visiblePages),i>this.options.totalPages&&(t=this.options.totalPages-this.options.visiblePages+1,i=this.options.totalPages),r=t;r<=i;)u.push(r),r++;return{currentPage:n,numeric:u}},render:function(t){var i=this;this.$listContainer.children().remove();this.$listContainer.append(this.buildListItems(t));this.$listContainer.children().each(function(){var r=n(this),u=r.data("page-type");switch(u){case"page":r.data("page")===t.currentPage&&r.addClass(i.options.activeClass);break;case"first":r.toggleClass(i.options.disabledClass,t.currentPage===1);break;case"last":r.toggleClass(i.options.disabledClass,t.currentPage===i.options.totalPages);break;case"prev":r.toggleClass(i.options.disabledClass,!i.options.loop&&t.currentPage===1);break;case"next":r.toggleClass(i.options.disabledClass,!i.options.loop&&t.currentPage===i.options.totalPages)}})},setupEvents:function(){var t=this;this.$listContainer.find("li").each(function(){var i=n(this);if(i.off(),i.hasClass(t.options.disabledClass)||i.hasClass(t.options.activeClass)){i.on("click",!1);return}i.click(function(n){t.options.href||n.preventDefault();t.show(parseInt(i.data("page")))})})},makeHref:function(n){return this.options.href?this.options.href.replace(this.options.hrefVariable,n):"#"}};n.fn.twbsPagination=function(t){var o=Array.prototype.slice.call(arguments,1),f,e=n(this),i=e.data("twbs-pagination"),s=typeof t=="object"&&t;return i||e.data("twbs-pagination",i=new u(this,s)),typeof t=="string"&&(f=i[t].apply(i,o)),f===r?e:f};n.fn.twbsPagination.defaults={totalPages:0,startPage:1,visiblePages:5,initiateStartPageClick:!0,href:!1,hrefVariable:"{{number}}",first:"首页",prev:"上一页",next:"下一页",last:"末页",loop:!1,onPageClick:null,paginationClass:"pagination",nextClass:"next",prevClass:"prev",lastClass:"last",firstClass:"first",pageClass:"page",activeClass:"active",disabledClass:"disabled"};n.fn.twbsPagination.Constructor=u;n.fn.twbsPagination.noConflict=function(){return n.fn.twbsPagination=f,this}}(window.jQuery,window,document)